# 동시성 문제 보고서

---
### 이커머스 서비스 구현 기능 리스트
1. 상품 주문 - 재고 확인하여 주문가능 여부 확인
2. 상품 결제
    - 상품 재고 차감
    - 쿠폰 사용
    - 포인트 사용
3. 포인트 충전
4. 쿠폰 발급

---
### [문제 식별] 서비스 내 동시성 발생 가능 상황
1. 상품 재고 차감: 여러번 요청 시 재고 무결성이 지켜지지 않을 수 있다.
2. 쿠폰 사용: 쿠폰이 이미 사용됐는데 또 사용될 수 있다.
3. 포인트 충전 및 사용: 두 번 충전되거나, 두 번 사용될 수 있다.
4. 쿠폰 발급: 여러번 요청 시 재고 무결성이 지켜지지 않을 수 있다. 중복 발급이 될 수 있다.

---
### [분석 및 해결] DB Lock 설계
1. 상품 재고 차감: 비관적 락 적용
    - 여러 사용자가 상품 재고 정보에 동시 접근 할 수 있기 때문에 충돌 가능성이 높아, 비관적 락 적용
2. 쿠폰 사용: 낙관적 락 적용
    - 한명의 사용자가 자신의 쿠폰 정보에 접근하기 때문에 충돌 가능성이 낮아, 낙관적 락 적용
3. 포인트 충전 및 사용: 낙관적 락 적용
    - 한명의 사용자가 자신의 포인트 정보에 접근하기 때문에 충돌 가능성이 낮아, 낙관적 락 적용
4. 쿠폰 발급: 비관적 락 적용
    - 여러 사용자가 쿠폰 재고 정보에 동시 접근 할 수 있기 때문에 충돌 가능성이 높아, 비관적 락 적용